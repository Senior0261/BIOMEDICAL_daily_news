<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AI Ã— ç”Ÿç‰©åŒ»å­¦ Â· å¾®æµæ§ Â· ç”Ÿç‰©ä¿¡æ¯å­¦ â€”â€” æ¯æ—¥æ–°é—»ï¼ˆJSTï¼‰</title>
<meta name="color-scheme" content="light dark" />
<style>
  :root{--bg:Canvas;--text:CanvasText;--muted:color-mix(in oklab,var(--text) 60%,transparent);--card:color-mix(in oklab,var(--bg) 85%,var(--text));--accent:#4c8bf5;--chip-bg:color-mix(in oklab,var(--accent) 12%,transparent);--chip-text:color-mix(in oklab,var(--accent) 80%,var(--text));--shadow:0 10px 30px color-mix(in oklab, black 20%, transparent);--radius:14px;--radius-sm:10px;--radius-xs:8px;--grid:minmax(260px,1fr);--maxw:1200px;}
  *{box-sizing:border-box} html,body{margin:0;background:var(--bg);color:var(--text);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"PingFang SC","Noto Sans CJK SC","Noto Sans JP",sans-serif}
  a{color:var(--accent);text-decoration:none} a:hover{text-decoration:underline}
  header{position:sticky;top:0;z-index:10;backdrop-filter:blur(8px);background:color-mix(in oklab,var(--bg) 70%,transparent);border-bottom:1px solid color-mix(in oklab,var(--text) 10%,transparent)}
  .wrap{max-width:var(--maxw);margin:0 auto;padding:16px}
  .titlebar{display:flex;gap:14px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  .brand{display:flex;align-items:center;gap:12px}
  .logo{width:36px;height:36px;border-radius:10px;background:var(--chip-bg);display:grid;place-items:center;color:var(--chip-text);font-weight:700;border:1px solid color-mix(in oklab,var(--accent) 30%,transparent)}
  h1{font-size:clamp(18px,2.4vw,24px);margin:0}
  .date{color:var(--muted);font-weight:600}
  .controls{display:flex;gap:10px;flex-wrap:wrap}
  .search{display:flex;align-items:center;gap:8px;padding:10px 12px;border:1px solid color-mix(in oklab,var(--text) 12%,transparent);border-radius:10px;background:var(--bg);min-width:260px}
  .search input{border:none;outline:none;background:transparent;color:var(--text);width:220px}
  .btn{border:1px solid color-mix(in oklab,var(--accent) 40%,transparent);background:color-mix(in oklab,var(--accent) 8%,var(--bg));color:var(--chip-text);padding:10px 12px;border-radius:10px;cursor:pointer}
  .tabs{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
  .tab{padding:8px 12px;border-radius:8px;border:1px solid color-mix(in oklab,var(--text) 12%,transparent);cursor:pointer;background:var(--bg)}
  .tab.active{background:color-mix(in oklab,var(--accent) 18%,var(--bg));border-color:color-mix(in oklab,var(--accent) 40%,transparent);color:var(--chip-text)}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,var(--grid));gap:18px;margin-top:16px}
  .card{background:var(--card);border-radius:14px;overflow:hidden;box-shadow:var(--shadow);border:1px solid color-mix(in oklab,var(--text) 10%,transparent);display:flex;flex-direction:column}
  .thumb{width:100%;aspect-ratio:16/9;object-fit:cover;background:#ddd}
  .content{padding:14px 14px 8px}
  .title{font-size:17px;font-weight:700;margin:0 0 6px;line-height:1.4}
  .meta{display:flex;gap:8px;align-items:center;flex-wrap:wrap;color:var(--muted);font-size:13px;margin:4px 0 10px}
  .chips{display:flex;gap:6px;flex-wrap:wrap;margin-top:4px}
  .chip{padding:4px 8px;font-size:12px;border-radius:999px;background:var(--chip-bg);color:var(--chip-text);border:1px solid color-mix(in oklab,var(--accent) 30%,transparent)}
  .desc{opacity:.9;font-size:14px}
  .foot{display:flex;align-items:center;justify-content:space-between;padding:10px 14px 14px;margin-top:auto}
  .src{display:flex;align-items:center;gap:8px;color:var(--muted);font-size:13px}
  .src img{width:16px;height:16px;border-radius:4px;object-fit:cover;background:#ccc}
  @media print{header,.controls,.tabs{display:none!important}.grid{grid-template-columns:1fr 1fr}.card{break-inside:avoid;box-shadow:none;border:1px solid #ccc}}
  .empty{border:2px dashed color-mix(in oklab,var(--text) 20%,transparent);padding:22px;border-radius:16px;color:var(--muted);display:grid;place-items:center;min-height:160px;text-align:center}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="titlebar">
      <div class="brand">
        <div class="logo">AI</div>
        <div>
          <h1>æ¯æ—¥æ–°é—» Â· AIï¼ˆç”Ÿç‰©åŒ»å­¦ï¼‰ï½œå¾®æµæ§ï½œç”Ÿç‰©ä¿¡æ¯å­¦</h1>
          <div class="date" id="today"></div>
        </div>
      </div>
      <div class="controls">
        <label class="search">ğŸ” <input id="q" placeholder="æœç´¢æ ‡é¢˜ / æ‘˜è¦ / æ ‡ç­¾ / æ¥æºâ€¦" /></label>
        <button class="btn" id="printBtn">å¯¼å‡º PDF</button>
        <button class="btn" id="copyMD">å¤åˆ¶ä»Šæ—¥ Markdown æ‘˜è¦</button>
      </div>
    </div>
    <div class="tabs" id="tabs">
      <div class="tab active" data-cat="ai_biomed">AIï¼ˆèšç„¦ç”Ÿç‰©åŒ»å­¦ï¼‰</div>
      <div class="tab" data-cat="microfluidics">å¾®æµæ§</div>
      <div class="tab" data-cat="bioinfo">ç”Ÿç‰©ä¿¡æ¯å­¦</div>
    </div>
  </div>
</header>

<main class="wrap">
  <section class="section active" id="ai_biomed">
    <h2>AIï¼ˆç”Ÿç‰©åŒ»å­¦ï¼‰</h2>
    <div class="grid" id="grid-ai_biomed"></div>
    <div class="empty" id="empty-ai_biomed" hidden>ä»Šå¤©è¿™ä¸ªæ¿å—è¿˜æ²¡æœ‰å†…å®¹ã€‚</div>
  </section>
  <section class="section" id="microfluidics">
    <h2>å¾®æµæ§</h2>
    <div class="grid" id="grid-microfluidics"></div>
    <div class="empty" id="empty-microfluidics" hidden>ä»Šå¤©è¿™ä¸ªæ¿å—è¿˜æ²¡æœ‰å†…å®¹ã€‚</div>
  </section>
  <section class="section" id="bioinfo">
    <h2>ç”Ÿç‰©ä¿¡æ¯å­¦</h2>
    <div class="grid" id="grid-bioinfo"></div>
    <div class="empty" id="empty-bioinfo" hidden>ä»Šå¤©è¿™ä¸ªæ¿å—è¿˜æ²¡æœ‰å†…å®¹ã€‚</div>
  </section>
</main>

<footer><div class="wrap" style="color:#777;font-size:13px">è¯´æ˜ï¼šæ¯æ¡æ–°é—»å‡é™„æ¥æºé“¾æ¥å’Œå°é¢å›¾ï¼ˆOpenGraph/Twitter å¡ç‰‡è‡ªåŠ¨æŠ½å–ï¼‰ã€‚JST è‡ªåŠ¨è¯†åˆ«å½“æ—¥ã€‚</div></footer>

<script>
  const tz = "Asia/Tokyo";
  function fmtDateISOToJP(d){
    try{
      const dt = new Date(d);
      const opt = { timeZone: tz, year:"numeric", month:"2-digit", day:"2-digit", weekday:"short" };
      const s = new Intl.DateTimeFormat("zh-CN", opt).format(dt);
      return s.replace(/\//g, "-");
    }catch{ return d }
  }
  function fmtTime(d){
    if(!d) return "";
    try{
      const dt = new Date(d);
      const opt = { timeZone: tz, year:"numeric", month:"2-digit", day:"2-digit" };
      return new Intl.DateTimeFormat("zh-CN", opt).format(dt).replace(/\//g,"-");
    }catch{ return d }
  }
  function todayJST() {
    const now = new Date();
    const opt = { timeZone: tz, year:"numeric", month:"2-digit", day:"2-digit" };
    return new Intl.DateTimeFormat("en-CA", opt).format(now); // YYYY-MM-DD
  }
  async function loadData(dateStr){
    const tries = [dateStr];
    const d = new Date(dateStr); d.setDate(d.getDate()-1);
    tries.push(d.toISOString().slice(0,10));
    for(const t of tries){
      const url = `./data/${t}.json`;
      try{
        const r = await fetch(url, {cache:"no-store"});
        if(r.ok) return await r.json();
      }catch{}
    }
    return {date: dateStr, items:{ai_biomed:[], microfluidics:[], bioinfo:[]}};
  }

  let data = {date: "", items:{ai_biomed:[], microfluidics:[], bioinfo:[]}};
  const state = {cat:"ai_biomed", q:""};

  function matchQuery(it, q){
    if(!q) return true;
    const hay = [it.title, it.summary, it.source, ...(it.tags||[])].join(" ").toLowerCase();
    return hay.includes(q.toLowerCase());
  }
  function card(it){
    const time = fmtTime(it.time);
    const tags = (it.tags||[]).map(t=>`<span class="chip">${t}</span>`).join("");
    return `
      <article class="card">
        <img class="thumb" src="${it.cover||''}" alt="" onerror="this.src='data:image/svg+xml;utf8,${encodeURIComponent('<svg xmlns=\\'http://www.w3.org/2000/svg\\' viewBox=\\'0 0 600 338\\'><rect width=\\'100%\\' height=\\'100%\\' fill=\\'#ddd\\'/><text x=\\'50%\\' y=\\'50%\\' text-anchor=\\'middle\\' fill=\\'#777\\' font-size=\\'18\\' font-family=\\'system-ui\\'>No Cover</text></svg>')}'"/>
        <div class="content">
          <h3 class="title"><a href="${it.url}" target="_blank" rel="noopener">${it.title}</a></h3>
          <div class="meta"><span>æ¥æºï¼š${it.source||'æœªçŸ¥'}</span>${time?`<span>Â· å‘å¸ƒï¼š${time}</span>`:''}</div>
          <p class="desc">${it.summary||''}</p>
          <div class="chips">${tags}</div>
        </div>
        <div class="foot">
          <div class="src">å¤–é“¾ï¼š<a href="${it.url}" target="_blank" rel="noopener">${new URL(it.url).host}</a></div>
          <a class="btn" href="${it.url}" target="_blank" rel="noopener">å‰å¾€é˜…è¯» â†—</a>
        </div>
      </article>`;
  }
  function mount(){
    document.getElementById("today").textContent = `ä»Šå¤©ï¼ˆæ—¥æœ¬æ—¶åŒºï¼‰ï¼š${fmtDateISOToJP(data.date)} Â· å…± ${
      ["ai_biomed","microfluidics","bioinfo"].map(k=>data.items[k]?.length||0).reduce((a,b)=>a+b,0)
    } æ¡`;
    for(const cat of ["ai_biomed","microfluidics","bioinfo"]){
      const grid = document.getElementById(`grid-${cat}`);
      const empty = document.getElementById(`empty-${cat}`);
      const arr = (data.items[cat]||[]).filter(it=>matchQuery(it, state.q));
      grid.innerHTML = arr.map(card).join("");
      empty.hidden = arr.length>0;
    }
    for(const t of document.querySelectorAll(".tab")){
      t.classList.toggle("active", t.dataset.cat===state.cat);
    }
    document.getElementById("ai_biomed").parentElement.querySelectorAll(".section").forEach(sec=>{
      sec.classList.toggle("section", true);
      sec.style.display = (sec.id===state.cat)?"block":"none";
    });
  }
  document.getElementById("q").addEventListener("input", e=>{ state.q=e.target.value.trim(); mount(); });
  document.getElementById("printBtn").onclick = ()=>window.print();
  document.getElementById("copyMD").onclick = async ()=>{
    const url = `./data/${data.date}.md`;
    try{ const r = await fetch(url,{cache:"no-store"}); if(r.ok){ const txt = await r.text(); await navigator.clipboard.writeText(txt); alert("å·²å¤åˆ¶ä»Šæ—¥ Markdown æ‘˜è¦"); return; } }catch{}
    alert("æœªæ‰¾åˆ°ä»Šæ—¥ Markdown æ–‡ä»¶");
  };
  for(const t of document.querySelectorAll(".tab")){
    t.addEventListener("click", ()=>{ state.cat=t.dataset.cat; mount(); });
  }
  (async ()=>{
    const dateStr = todayJST();
    data = await loadData(dateStr);
    mount();
  })();
</script>
</body>
</html>
